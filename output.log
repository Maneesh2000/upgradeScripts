üîÑ Running in continuous mode, checking every 10 seconds...
Press Ctrl+C to stop


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:21:01.231Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842671873' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300037'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796011'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915871295' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645048'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692722'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864161473' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423580'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771672'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 55%
  Heap Used: 2.21 GB / 4 GB

Garbage Collection:
  Young GC Count: 40962 (Time: 1217181ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 14%
  Load Average: 0.52

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 84% ‚ö†Ô∏è HIGH
  Heap Used: 3.36 GB / 4 GB

Garbage Collection:
  Young GC Count: 33524 (Time: 936289ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 15%
  Load Average: 0.59

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 21%
  Heap Used: 885.92 MB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 10%
  Load Average: 0.59

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,428 documents
  Index Time: 3.36m
  Indexing Rate: 2485.17 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,063
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.38 refreshes/min

Search Metrics:
  Total Searches: 1,600,635
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,786
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 3.37 GB / 3.8 GB (88.65%) ‚ö†Ô∏è HIGH
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 897.92 MB / 3.8 GB (23.08%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.21 GB / 3.8 GB (58.23%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 90
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:02.249Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.3% (1.6ms out of 500ms) cpu usage by thread 'Log4j2-TF-13-AsyncLoggerConfig-2'
       10/10 snapshots sharing following 10 elements
         java.base@21.0.6/java.lang.Object.wait0(Native Method)
         java.base@21.0.6/java.lang.Object.wait(Object.java:366)
         java.base@21.0.6/java.lang.Object.wait(Object.java:488)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.awaitNanos(TimeoutBlockingWaitStrategy.java:130)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:86)
         app//com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
         app//com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:159)
         app//com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:02.250Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.3% (1.4ms out of 500ms) cpu usage by thread 'Log4j2-TF-13-AsyncLoggerConfig-2'
       10/10 snapshots sharing following 10 elements
         java.base@21.0.6/java.lang.Object.wait0(Native Method)
         java.base@21.0.6/java.lang.Object.wait(Object.java:366)
         java.base@21.0.6/java.lang.Object.wait(Object.java:488)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.awaitNanos(TimeoutBlockingWaitStrategy.java:130)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:86)
         app//com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
         app//com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:159)
         app//com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  Node 9818db6f80de82ef6e3a8ad5a4482438 JVM memory at 84% - High memory pressure
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562062899.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:21:12.904Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864163441' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423580'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771672'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842673805' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300037'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796011'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915873383' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645048'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692722'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 1958 rejected operations
   - search: 14751 rejected operations
   - search: 1159 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 18%
  Heap Used: 765.88 MB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 20%
  Load Average: 1.02

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 24%
  Heap Used: 1021.92 MB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 8%
  Load Average: 0.72

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 57%
  Heap Used: 2.29 GB / 4 GB

Garbage Collection:
  Young GC Count: 40962 (Time: 1217181ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 4%
  Load Average: 1.40

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,428 documents
  Index Time: 3.36m
  Indexing Rate: 2485.17 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,063
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.38 refreshes/min

Search Metrics:
  Total Searches: 1,600,635
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,786
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.31 GB / 3.8 GB (60.70%)
    Tripped: 173 times

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 769.88 MB / 3.8 GB (19.79%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1 GB / 3.8 GB (26.42%)
    Tripped: 216 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 90
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:13.645Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:13.644Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:13.645Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562074298.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:21:24.312Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842675576' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300063'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796012'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915875297' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645072'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692728'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864165245' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423600'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771675'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 61%
  Heap Used: 2.46 GB / 4 GB

Garbage Collection:
  Young GC Count: 40962 (Time: 1217181ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 10%
  Load Average: 1.18

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 23%
  Heap Used: 959.88 MB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 6%
  Load Average: 0.87

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 29%
  Heap Used: 1.16 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 7%
  Load Average: 0.61

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,432 documents
  Index Time: 3.36m
  Indexing Rate: 2485.15 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,069
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.39 refreshes/min

Search Metrics:
  Total Searches: 1,600,650
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,788
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 985.88 MB / 3.8 GB (25.34%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.18 GB / 3.8 GB (30.94%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.47 GB / 3.8 GB (65.07%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:25.195Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.2% (840.2micros out of 500ms) cpu usage by thread 'Log4j2-TF-13-AsyncLoggerConfig-2'
       10/10 snapshots sharing following 10 elements
         java.base@21.0.6/java.lang.Object.wait0(Native Method)
         java.base@21.0.6/java.lang.Object.wait(Object.java:366)
         java.base@21.0.6/java.lang.Object.wait(Object.java:488)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.awaitNanos(TimeoutBlockingWaitStrategy.java:130)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:86)
         app//com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
         app//com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:159)
         app//com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:25.194Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:25.194Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562085847.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:21:35.856Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864167213' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423650'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771680'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842677508' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300114'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796015'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915877385' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645125'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692742'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 1958 rejected operations
   - search: 14751 rejected operations
   - search: 1159 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 27%
  Heap Used: 1.1 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 10%
  Load Average: 0.81

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 33%
  Heap Used: 1.32 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 7%
  Load Average: 0.54

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 65%
  Heap Used: 2.64 GB / 4 GB

Garbage Collection:
  Young GC Count: 40962 (Time: 1217181ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 9%
  Load Average: 0.92

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.65 GB / 3.8 GB (69.64%)
    Tripped: 173 times

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.1 GB / 3.8 GB (28.93%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.33 GB / 3.8 GB (34.95%)
    Tripped: 216 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:36.574Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:36.573Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:36.574Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562097222.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:21:47.224Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842679279' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300149'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915879299' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645142'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864169017' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423689'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 31%
  Heap Used: 1.25 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 8%
  Load Average: 0.69

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 37%
  Heap Used: 1.49 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 6%
  Load Average: 0.53

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 73%
  Heap Used: 2.94 GB / 4 GB

Garbage Collection:
  Young GC Count: 40962 (Time: 1217181ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 19%
  Load Average: 0.78

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.26 GB / 3.8 GB (33.15%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.49 GB / 3.8 GB (39.32%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.95 GB / 3.8 GB (77.61%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:47.908Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:47.910Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.1% (402.1micros out of 500ms) cpu usage by thread 'Log4j2-TF-13-AsyncLoggerConfig-2'
       10/10 snapshots sharing following 10 elements
         java.base@21.0.6/java.lang.Object.wait0(Native Method)
         java.base@21.0.6/java.lang.Object.wait(Object.java:366)
         java.base@21.0.6/java.lang.Object.wait(Object.java:488)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.awaitNanos(TimeoutBlockingWaitStrategy.java:130)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:86)
         app//com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
         app//com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:159)
         app//com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:47.910Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562108557.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:21:58.565Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842681050' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300149'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915881213' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645142'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864170821' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423689'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 32%
  Heap Used: 1.3 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 13%
  Load Average: 0.58

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 38%
  Heap Used: 1.54 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 14%
  Load Average: 0.53

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 78% ‚ö†Ô∏è HIGH
  Heap Used: 3.13 GB / 4 GB

Garbage Collection:
  Young GC Count: 40962 (Time: 1217181ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 7%
  Load Average: 0.66

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.31 GB / 3.8 GB (34.59%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.54 GB / 3.8 GB (40.50%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 3.14 GB / 3.8 GB (82.55%) ‚ö†Ô∏è HIGH
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:59.210Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.1% (491micros out of 500ms) cpu usage by thread 'Log4j2-TF-13-AsyncLoggerConfig-2'
       10/10 snapshots sharing following 10 elements
         java.base@21.0.6/java.lang.Object.wait0(Native Method)
         java.base@21.0.6/java.lang.Object.wait(Object.java:366)
         java.base@21.0.6/java.lang.Object.wait(Object.java:488)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.awaitNanos(TimeoutBlockingWaitStrategy.java:130)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:86)
         app//com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
         app//com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:159)
         app//com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:59.212Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:21:59.212Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  Node 2ddfbbd32fc0d8e7ed87e5a98a73932f JVM memory at 78% - High memory pressure
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562119859.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:22:09.865Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842682982' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300149'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915883301' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645142'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864172625' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423689'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 81% ‚ö†Ô∏è HIGH
  Heap Used: 3.27 GB / 4 GB

Garbage Collection:
  Young GC Count: 40962 (Time: 1217181ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 10%
  Load Average: 0.51

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 36%
  Heap Used: 1.45 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 27%
  Load Average: 0.67

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 40%
  Heap Used: 1.63 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 45%
  Load Average: 0.79

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.45 GB / 3.8 GB (38.29%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.64 GB / 3.8 GB (43.07%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 3.28 GB / 3.8 GB (86.19%) ‚ö†Ô∏è HIGH
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:10.570Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.4% (1.9ms out of 500ms) cpu usage by thread 'opensearch[9818db6f80de82ef6e3a8ad5a4482438][transport_worker][T#1]'
       2/10 snapshots sharing following 4 elements
         io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)
         io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:10.563Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:10.570Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  Node 2ddfbbd32fc0d8e7ed87e5a98a73932f JVM memory at 81% - High memory pressure
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562131216.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:22:21.226Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864174593' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423690'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842684753' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300153'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915885215' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645143'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 1958 rejected operations
   - search: 14751 rejected operations
   - search: 1159 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 40%
  Heap Used: 1.63 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 8%
  Load Average: 0.72

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 42%
  Heap Used: 1.7 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 8%
  Load Average: 0.67

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 18%
  Heap Used: 749.14 MB / 4 GB

Garbage Collection:
  Young GC Count: 40963 (Time: 1217208ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 9%
  Load Average: 0.43

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 761.14 MB / 3.8 GB (19.56%)
    Tripped: 173 times

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.64 GB / 3.8 GB (43.17%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.71 GB / 3.8 GB (44.87%)
    Tripped: 216 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:22.001Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:22.001Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:22.001Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562142652.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:22:32.661Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842686524' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300153'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915887129' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645143'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864176397' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423690'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 42%
  Heap Used: 1.7 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 5%
  Load Average: 0.61

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 47%
  Heap Used: 1.88 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 5%
  Load Average: 0.57

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 19%
  Heap Used: 819.14 MB / 4 GB

Garbage Collection:
  Young GC Count: 40963 (Time: 1217208ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 6%
  Load Average: 0.36

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.71 GB / 3.8 GB (44.97%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.89 GB / 3.8 GB (49.85%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 825.14 MB / 3.8 GB (21.21%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:33.312Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      1.1% (5.7ms out of 500ms) cpu usage by thread 'opensearch[2ddfbbd32fc0d8e7ed87e5a98a73932f][transport_worker][T#1]'
       4/10 snapshots sharing following 4 elements
         io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)
         io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:33.319Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.1% (558micros out of 500ms) cpu usage by thread 'Log4j2-TF-13-AsyncLoggerConfig-2'
       10/10 snapshots sharing following 10 elements
         java.base@21.0.6/java.lang.Object.wait0(Native Method)
         java.base@21.0.6/java.lang.Object.wait(Object.java:366)
         java.base@21.0.6/java.lang.Object.wait(Object.java:488)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.awaitNanos(TimeoutBlockingWaitStrategy.java:130)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:86)
         app//com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
         app//com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:159)
         app//com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:33.319Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562153966.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:22:43.970Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842688456' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300153'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915889217' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645143'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864178365' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423690'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 44%
  Heap Used: 1.78 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 5%
  Load Average: 0.51

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 50%
  Heap Used: 2.02 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 7%
  Load Average: 0.48

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 22%
  Heap Used: 929.14 MB / 4 GB

Garbage Collection:
  Young GC Count: 40963 (Time: 1217208ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 7%
  Load Average: 0.31

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.79 GB / 3.8 GB (47.23%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.03 GB / 3.8 GB (53.35%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 935.14 MB / 3.8 GB (24.03%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:44.645Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:44.647Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:44.647Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562165293.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:22:55.303Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842690227' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300153'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915891131' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645143'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864180169' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423690'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 49%
  Heap Used: 1.97 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 3%
  Load Average: 0.62

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 52%
  Heap Used: 2.1 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 14%
  Load Average: 0.45

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 26%
  Heap Used: 1.05 GB / 4 GB

Garbage Collection:
  Young GC Count: 40963 (Time: 1217208ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 12%
  Load Average: 0.68

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.98 GB / 3.8 GB (52.22%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.1 GB / 3.8 GB (55.30%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.07 GB / 3.8 GB (28.25%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:22:55.941Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
     10.0% (49.8ms out of 500ms) cpu usage by thread 'opensearch[2ddfbbd32fc0d8e7ed87e5a98a73932f][generic][T#3]'
       9/10 snapshots sharing following 106 elements
         java.base@21.0.6/sun.nio.ch.Net.poll(Native Method)
         java.base@21.0.6/sun.nio.ch.NioSocketImpl.park(NioSocketImpl.java:191)
         java.base@21.0.6/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:280)
         java.base@21.0.6/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:304)
         java.base@21.0.6/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:346)
         java.base@21.0.6/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:796)
         java.base@21.0.6/java.net.Socket$SocketInputStream.read(Socket.java:1099)
         java.base@21.0.6/sun.security.ssl.SSLSocketInputRecord.read(SSLSocketInputRecord.java:489)
         java.base@21.0.6/sun.security.ssl.SSLSocketInputRecord.readHeader(SSLSocketInputRecord.java:483)
         java.base@21.0.6/sun.security.ssl.SSLSocketInputRecord.bytesInCompletePacket(SSLSocketInputRecord.java:70)
         java.base@21.0.6/sun.security.ssl.SSLSocketImpl.readApplicationRecord(SSLSocketImpl.java:1461)
         java.base@21.0.6/sun.security.ssl.SSLSocketImpl$AppInputStream.read(SSLSocketImpl.java:1066)
         app//org.apache.http.impl.io.SessionInputBufferImpl.streamRead(SessionInputBufferImpl.java:137)
         app//org.apache.http.impl.io.SessionInputBufferImpl.fillBuffer(SessionInputBufferImpl.java:153)
         app//org.apache.http.impl.io.SessionInputBufferImpl.readLine(SessionInputBufferImpl.java:280)
         org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:138)
         org.apache.http.impl.conn.DefaultHttpResponseParser.parseHead(DefaultHttpResponseParser.java:56)
         app//org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:259)
         app//org.apache.http.impl.DefaultBHttpClientConnection.receiveResponseHeader(DefaultBHttpClientConnection.java:163)
         org.apache.http.impl.conn.CPoolProxy.receiveResponseHeader(CPoolProxy.java:157)
         app//org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:273)
         app//org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:125)
         org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:272)
         org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:186)
         org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562176618.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:23:06.623Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842692159' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300153'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915893219' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645143'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864181973' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423690'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 32%
  Heap Used: 1.29 GB / 4 GB

Garbage Collection:
  Young GC Count: 40963 (Time: 1217208ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 44%
  Load Average: 0.82

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 51%
  Heap Used: 2.06 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 81% ‚ö†Ô∏è HIGH
  Load Average: 0.92

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 54%
  Heap Used: 2.18 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 56%
  Load Average: 1.07

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.07 GB / 3.8 GB (54.53%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.18 GB / 3.8 GB (57.46%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.3 GB / 3.8 GB (34.16%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:23:07.498Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:23:07.497Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:23:07.498Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  Node 9818db6f80de82ef6e3a8ad5a4482438 CPU at 81% - High CPU usage
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562188156.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...


================================================================================
OPENSEARCH METRICS CHECK - 2025-11-19T14:23:18.162Z
================================================================================

OpenSearch client initialized successfully
Connected to: https://search-new-qa-es-ubxk5x5e3hjlhkoi4z7ccrdoza.ap-south-1.es.amazonaws.com/

================================================================================
CLUSTER HEALTH
================================================================================
Status: GREEN ‚úÖ
Active Nodes: 3
Active Data Nodes: 3
Active Shards: 1090
Relocating Shards: 0
Initializing Shards: 0
Unassigned Shards: 0
Delayed Unassigned Shards: 0
Pending Tasks: 0
In Flight Fetch: 0
Task Max Wait Time: 0ms

================================================================================
THREAD POOL METRICS (CRITICAL)
================================================================================

CRITICAL POOLS:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (index) ‚îÇ   Pool    ‚îÇ Active ‚îÇ Queue ‚îÇ Rejected  ‚îÇ Queue Size ‚îÇ  Completed  ‚îÇ Largest ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    0    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '798'    ‚îÇ   '1'   ‚îÇ
‚îÇ    1    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '842693930' ‚îÇ   '1'   ‚îÇ
‚îÇ    2    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '14751 ‚ö†Ô∏è' ‚îÇ   '1000'   ‚îÇ '11300153'  ‚îÇ   '2'   ‚îÇ
‚îÇ    3    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '796020'   ‚îÇ   '1'   ‚îÇ
‚îÇ    4    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '712'    ‚îÇ   '1'   ‚îÇ
‚îÇ    5    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '915895133' ‚îÇ   '1'   ‚îÇ
‚îÇ    6    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1159 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '10645143'  ‚îÇ   '2'   ‚îÇ
‚îÇ    7    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '692746'   ‚îÇ   '1'   ‚îÇ
‚îÇ    8    ‚îÇ   'get'   ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ   '1000'   ‚îÇ    '589'    ‚îÇ   '1'   ‚îÇ
‚îÇ    9    ‚îÇ 'refresh' ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ    '-1'    ‚îÇ '864183941' ‚îÇ   '1'   ‚îÇ
‚îÇ   10    ‚îÇ 'search'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ '1958 ‚ö†Ô∏è'  ‚îÇ   '1000'   ‚îÇ '11423690'  ‚îÇ   '2'   ‚îÇ
‚îÇ   11    ‚îÇ  'write'  ‚îÇ  '0'   ‚îÇ  '0'  ‚îÇ    '0'    ‚îÇ  '10000'   ‚îÇ  '771684'   ‚îÇ   '1'   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ö†Ô∏è  REJECTIONS DETECTED:
   - search: 14751 rejected operations
   - search: 1159 rejected operations
   - search: 1958 rejected operations

================================================================================
NODE RESOURCE METRICS
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
JVM Memory Pressure: 36%
  Heap Used: 1.46 GB / 4 GB

Garbage Collection:
  Young GC Count: 40963 (Time: 1217208ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 3%
  Load Average: 0.69

Thread Pool Rejections:
  search: 1958 rejected ‚ö†Ô∏è

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
JVM Memory Pressure: 54%
  Heap Used: 2.2 GB / 4 GB

Garbage Collection:
  Young GC Count: 33526 (Time: 936370ms)
  Old GC Count: 1 (Time: 1083ms)

CPU Utilization: 10%
  Load Average: 0.78

Thread Pool Rejections:
  search: 14751 rejected ‚ö†Ô∏è

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
JVM Memory Pressure: 56%
  Heap Used: 2.25 GB / 4 GB

Garbage Collection:
  Young GC Count: 30781 (Time: 828139ms)
  Old GC Count: 0 (Time: 0ms)

CPU Utilization: 11%
  Load Average: 0.91

Thread Pool Rejections:
  search: 1159 rejected ‚ö†Ô∏è

================================================================================
INDEX PERFORMANCE METRICS - pms_green_dot
================================================================================

Indexing Metrics:
  Total Indexed: 500,440 documents
  Index Time: 3.36m
  Indexing Rate: 2485.14 docs/sec
  Current Indexing: 0 operations
  Failed: 271

üî¥ Refresh Metrics (CRITICAL):
  Total Refreshes: 375,078
  Refresh Time: 49.91m
  Avg Refresh Time: 7.98ms
  Estimated Refresh Capacity: 7514.43 refreshes/min

Search Metrics:
  Total Searches: 1,600,675
  Search Time: 9.16m
  Avg Search Time: 0.34ms
  Current Searches: 0

Merge Metrics:
  Total Merges: 39,789
  Merge Time: 11.87m
  Current Merges: 0

Storage:
  Total Size: N/A

================================================================================
INDEX PERFORMANCE METRICS - pms-user-rooms
================================================================================
Index not found or no data available

================================================================================
INDEX SETTINGS - pms_green_dot
================================================================================

Number of Shards: 5
Number of Replicas: 1
Refresh Interval: default (1s)
Auto Expand Replicas: false

================================================================================
INDEX SETTINGS - pms-user-rooms
================================================================================

================================================================================
CLUSTER SETTINGS
================================================================================

Circuit Breaker Limits:
  indices.breaker.fielddata.limit: 40%
  indices.breaker.fielddata.overhead: 1.03
  indices.breaker.fielddata.type: memory
  indices.breaker.request.limit: 60%
  indices.breaker.request.overhead: 1.0
  indices.breaker.request.type: memory
  indices.breaker.total.limit: 95%
  indices.breaker.total.use_real_memory: true
  indices.breaker.type: hierarchy

Thread Pool Settings:

  WRITE:
    queue_size: 1000
    size: 1
    queue_size: 10000
    size: 1

  SEARCH:
    core: 1
    keep_alive: 1m
    max: 4
    core: 1
    keep_alive: 5m
    max: 8
    core: 1
    keep_alive: 1m
    max: 4
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 100
    size: 1
    queue_size: 30
    size: 4
    queue_size: 10000
    size: 2
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 4
    queue_size: 10000
    size: 4
    queue_size: 10
    size: 1
    core: 1
    keep_alive: 30m
    max: 2
    auto_queue_frame_size: 2000
    max_queue_size: 1000
    min_queue_size: 1000
    queue_size: 1000
    size: 2
    target_response_time: 1s
    auto_queue_frame_size: 200
    max_queue_size: 100
    min_queue_size: 100
    queue_size: 100
    size: 1
    target_response_time: 1s

================================================================================
PENDING CLUSTER TASKS
================================================================================
‚úì No pending tasks

================================================================================
ACTIVE TASKS & LONG-RUNNING QUERIES
================================================================================

Active Search Tasks: 0
  >5s:  0 
  >10s: 0 
  >30s: 0 

‚úì No long-running queries detected

================================================================================
CIRCUIT BREAKER STATUS (Real-time)
================================================================================

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.21 GB / 3.8 GB (58.13%)
    Tripped: 76 times

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 2.26 GB / 3.8 GB (59.36%)
    Tripped: 216 times

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  REQUEST:
    Usage: 0 B / 2.4 GB (0.00%)
    Tripped: 0 times
  FIELDDATA:
    Usage: 0 B / 1.6 GB (0.00%)
    Tripped: 0 times
  PARENT:
    Usage: 1.47 GB / 3.8 GB (38.68%)
    Tripped: 173 times

üî¥ Total Circuit Breaker Trips: 465
   ‚ö†Ô∏è  Circuit breakers have tripped - queries were killed due to memory pressure

================================================================================
CACHE METRICS (Query Cache, Field Data, Request Cache)
================================================================================

Node: 2ddfbbd32fc0d8e7ed87e5a98a73932f
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.01 MB
    Hit Rate: 54.86%
    Evictions: 22,474 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 43.37 KB
    Hit Rate: 78.42%
    Evictions: 0

Node: 9818db6f80de82ef6e3a8ad5a4482438
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.35 MB
    Hit Rate: 57.45%
    Evictions: 34,669 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 55.38 KB
    Hit Rate: 79.33%
    Evictions: 0

Node: d4018776239cef6eea991c965b301191
--------------------------------------------------------------------------------
  Query Cache:
    Size: 10.37 MB
    Hit Rate: 57.18%
    Evictions: 25,081 ‚ö†Ô∏è
  Field Data Cache:
    Size: 0 B
    Evictions: 0
  Request Cache:
    Size: 44.8 KB
    Hit Rate: 77.33%
    Evictions: 0

‚ö†Ô∏è  HIGH CACHE EVICTION RATE - Indicates memory pressure

================================================================================
SEGMENT STATISTICS - pms_green_dot
================================================================================

Segment Count: 78
Segment Memory: 0 B
Fixed Bit Set Memory: 0 B

================================================================================
SEGMENT STATISTICS - pms-user-rooms
================================================================================
Index pms-user-rooms not found

================================================================================
THREAD POOL QUEUE SATURATION ANALYSIS
================================================================================

Queue Saturation by Pool:
  SEARCH (2ddfbbd32fc0d8e7ed87e5a98a73932f): 0.00% full
  SEARCH (9818db6f80de82ef6e3a8ad5a4482438): 0.00% full
  SEARCH (d4018776239cef6eea991c965b301191): 0.00% full

‚úì Queue saturation healthy

================================================================================
HOT THREADS ANALYSIS
================================================================================

Top CPU-consuming threads:
  ::: {9818db6f80de82ef6e3a8ad5a4482438}{rATihf4TR_eGnOuEwkZPsg}{rWUMThdmSCqpjhJZzoYL2Q}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1b, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:23:18.881Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
      0.1% (435.9micros out of 500ms) cpu usage by thread 'Log4j2-TF-13-AsyncLoggerConfig-2'
       10/10 snapshots sharing following 10 elements
         java.base@21.0.6/java.lang.Object.wait0(Native Method)
         java.base@21.0.6/java.lang.Object.wait(Object.java:366)
         java.base@21.0.6/java.lang.Object.wait(Object.java:488)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.awaitNanos(TimeoutBlockingWaitStrategy.java:130)
         app//org.apache.logging.log4j.core.async.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:86)
         app//com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
         app//com.lmax.disruptor.BatchEventProcessor.processEvents(BatchEventProcessor.java:159)
         app//com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:125)
         java.base@21.0.6/java.lang.Thread.runWith(Thread.java:1596)
         java.base@21.0.6/java.lang.Thread.run(Thread.java:1583)
  ::: {d4018776239cef6eea991c965b301191}{pYGq5d0oQU22ncGJcrRBkg}{A9EcWVMzSXaWgNzviQnVhA}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1a, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:23:18.880Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:
  ::: {2ddfbbd32fc0d8e7ed87e5a98a73932f}{nMYMK4X6TDWiCO1PT6XBiQ}{DmEmLOStRaClSL0ZVyUkqQ}{x.x.x.x}{x.x.x.x:9300}{dimr}{dp_version=20210501, admission_control_resource_tracker_feature_present=true, search_reactivation_counter_feature_present=true, adv_sec_enabled=true, cross_cluster_transport_address=x.x.x.x, awareness_features_enabled=true, search_backpressure_feature_present=true, coordinator_nodes_stats_feature_present=true, plugins.security.custom_serialization.enabled=false, distributed_snapshot_deletion_enabled=false, cold_enabled=false, zone=ap-south-1c, indices.doc_status_stats_enabled=true, global_cpu_usage_ac_supported=true, shard_indexing_pressure_enabled=true, task_cancellation_monitoring_feature_present=true}
     Hot threads at 2025-11-19T14:23:18.881Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:

================================================================================
CRITICAL ISSUES & RECOMMENDATIONS
================================================================================

üî¥ CRITICAL ISSUES:
   üî¥ SEARCH thread pool has 14751 rejections - System overloaded
   üî¥ SEARCH thread pool has 1159 rejections - System overloaded
   üî¥ SEARCH thread pool has 1958 rejections - System overloaded
   üî¥ Circuit breakers tripped 465 times - queries killed due to memory

‚ö†Ô∏è  WARNINGS:
   ‚ö†Ô∏è  High query cache evictions (82,224) - memory pressure

üí° ROOT CAUSE OF LOAD TEST FAILURE:
   All ES write operations use refresh:true, forcing immediate index refresh
   This blocks operations and causes 50-100x performance degradation
   Location: node_modules/@amurahealth/pms-utils/ESService.ts
   Fix: Change refresh:true to refresh:false in all operations

‚úÖ Metrics saved to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/opensearch-metrics-1763562199527.json
‚úÖ Summary appended to: /home/sharatheppalapally/Amura/Clones/clone2/upgradeScripts/metrics-output/metrics-summary.csv

‚è≥ Waiting 10 seconds before next check...

